# 프로세스와 사용자 명령 익히기



## 프로세스의 개념과 종류



### 프로세스의 개념

유닉스는 다중 프로세스 시스템이므로 여러 개의 프로세스를 동시에 실행할 수 있다.  유닉스에서 프로세스는 부모 - 자식 관계가 있다. 프로세스들은 각기 고유한 번호가 있으며 이를  PID라 한다.  

### 프로세스의 종류

- **데몬 프로세스**
  - 유닉스 커널에 의해 실행되고 특정 서비스를 제공하기 위해 존재한다. 데몬은 평소 대기 상태로 서비스 요청을 기다리다가 서비스 요청이 들어오면 해당 서비스를 제공한다.
- **부모 프로세스**
  - 부모 프로세스는 다른 프로세스를 만든다. 부팅할 때 실행되는 1번 프로세스를 제외한 모든 프로세스는 부모 프로세스를 가지고 있다.
- **자식 프로세스**
  - 자식 프로세스는 부모 프로세스에 의해 만들어지는 프로세스다. 자식 프로세스는 할 일이 끝나면 부모 프로세스에게 결과를 돌려주고 종료된다. 
- **고아 프로세스**
  - 자식 프로세스는 종료되면 부모 프로세스로 돌아간다. 그런데 자식 프로세스가 아직 실행중인데 부모 프로세스가 먼저 종료되어 버리면 자식 프로세스는 고아 프로세스가 된다. 이 경우 1번 프로세스가 새로운 부모 프로세스가 되어 고아 프로세스가 작업을 마치고 종료 할 수 있도록 해준다.
- **좀비 프로세스**
  - 자식 프로세스가 종료할 때 부모 프로세스에게 종료 정보를 보내고, 부모 프로세스가 이 정보를 받으면 프로세스 테이블 목록에서 자식 프로세스가 삭제된다. 그러나 자식 프로세스가 실행을 종료했는데도 프로세스 테이블 목록에 남아있는 경우 좀비 프로세스라고 한다.
  - 좀비 프로세스는 실제로 실행되고 있지는 않지만 동작 중인 프로세스 테이블 목록을 차지하고 있어, 좀비 프로세스가 증가한다면 프로세스 테이블이 꽉 차 다른 정상 프로세스가 실행할 수 없게 된다.
  - 좀비 프로세스는 kill 명령으로 제거할 수 없다. 좀비 프로세스를 제거하려면 부모 프로세스에게 SIGCHILD 시그널을 보내 부모 프로세스가 자식 프로세스를 정리하게 하거나, 부모 프로세스 자체를 종료시킨다. 부모 프로세스가 종료되면 좀비 프로세스는 고아 프로세스가 되고 새로운 부모인 init 프로세스는 자식 프로세스의 종료 정보를 주기적으로 확인하고 정리한다.



## 프로세스 관리 명령



### 프로세스 목록 보기 명령

- ps : 현재 실행중인 프로세스의 정보 출력
  - -e :  시스템에서 실행 중인 모든 프로세스 정보 출력
  - -f : 프로세스에 대한 자세한 정보 출력
    - UID : 프로세스를 실행시킨 사용자 ID
    - PID : 프로세스 번호
    - PPID : 부모 프로세스 번호
    - C : 프로세스 우선 순위
    - STIME : 프로세스의 시작 시간
    - TTY : 프로세스가 실행된 단말기 종류와 번호
    - TIME : 프로세스 실행 시간
    - CMD : 실행되고 있는 프로그램 이름
  - -u : 특정 사용자에 대한 모든 프로세스 출력



#### ps 명령을 이용해 특정 프로세스 정보 검색하기

ps -ef | grep bash



#### pgrep 명령을 이용해 특정 프로세스 정보 검색하기

- pgrep : 지정한 패턴과 일치하는 프로세스의 정보를 출력한다.
  - -x : 패턴과 정확히 일치하는 프로세스 정보 출력
  - -n : 패턴을 포함하고 있는 가장 최근의 프로세스 정보 출력
  - -u : uid. 특정 사용자의 모든 프로세스 출력
  - -l : PID와 프로세스 이름 출력
  - -t : term. 특정 단말기와 관련된 프로세스 정보 출력



### 프로세스 종료 명령



#### kill 명령을 이용해 프로세스 종료시키기

- kill 명령은 인자로 지정한 프로세스에 시그널을 전달한다. 시그널은 유닉스 시스템에서 프로세스에 간단한 메시지를 전달하는 방법으로 지정된 숫자를 전달한다.
  - 9(SIGKILL) : 강제 종료
    - 좀비 프로세스는 종료되지 않을 수도 있다.
  - 15(SIGTERM) : 프로세스 종료
  - 2(SIGINT) : 인터럽트



#### pkill 명령을 이용해 프로세스 종료시키기

- 프로세스 번호 대신 프로세스의 명령 이름으로 프로세스를 찾아 종료시킨다.
- 자신이 소유한 프로세스만 종료시킬수 있다.



### 프로세스 관리 도구

- prstat
  - 시스템에서 동작 중인 모든 프로세스를 주기적으로 확인하여 프로세스 정보를 출력한다.
  - 옵션 다시 보기!
- top
  - prstat에 비해 좀 더 자세한 요약 정보를 상단에 출력하고 각 프로세스 정보를 하단에 출력한다.



















